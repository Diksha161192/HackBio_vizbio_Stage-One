The objective of Stage One phase of the HackBio Data Visualisation with R was to design a solution code to calculate the molecular weight of a given protein sequence in Rscript that Proteins are polymers of amino acids, and their molecular weight can be estimated by summing the individual residue masses of individual amino acids forming that protein. To achieve this, a structured and modular programming approach was adopted, emphasizing input validation, biological accuracy, and usability. Enlisted below are the steps followed to achieve the objective:

1.     **\# Create a function named ‘Protein\_Weight\_Calculator’**: a reusable function named Protein\_Weight\_Calculator was created. Creating a function ensures that the tool can be applied to any protein sequence without rewriting code, thereby improving efficiency and reproducibility. The function accepts a single variable called **sequence**, representing the amino acid string of the protein.

2.     **\# Standardize the input sequence to UPPERCASE**: Once the function begins execution, the input sequence is standardized using the **toupper()** function. This step converts all characters into uppercase format, ensuring consistency regardless of whether the user provides lowercase or mixed-case input. Standardization is essential because amino acid residue codes are conventionally represented using uppercase single-letter abbreviations.

3.     **\# Create a vector with the weights of all amino acids (minus the weight of H20**): The next step involved defining a named numeric vector containing the molecular weights of the twenty standard amino acids. Each amino acid was represented by its single-letter code as the vector name, and its corresponding residue mass (i.e. weight of the amino acid - 18.05Da (weight of water)) as the value. Water mass is subtracted from each amino acid because one water molecule is lost during the formation of a peptide bond between two amino acids.

4.     **\# Split the string of protein sequence into individual letters of amino acids**: The protein sequence string was split into individual residues using the **strsplit()** function. This transformation converts the sequence into a character vector where each element corresponds to one amino acid. If the protein sequence is not split into its constituent amino acids, then R reads the entire sequence of protein as a single string variable and will treat it as one entity, thereby returning a value of 1 as weight of protein. Therefore, this is a vital step for protein weight calculation in R.

5.     **\# Check for invalid characters (i.e. non-amino acid characters like B, J, O, U, X and Z):** The function checks whether all residues in the sequence exist in the predefined amino acid weight vector. This step detects invalid or ambiguous characters such as B, J, O, U, X, or Z. If any invalid residue is identified, the function immediately returns a value of zero (0), preventing incorrect calculations and signalling that the input sequence is invalid.

6.     **\# Calculate the total weight (in Dalton):** The residue masses corresponding to each amino acid are retrieved from the vector and summed using the **sum()** function. To obtain the complete molecular weight of the protein, the **mass of one water molecule (i.e. 18.015 Da)** is added to the total residue mass. This adjustment accounts for the N-terminal hydrogen and C-terminal hydroxyl groups present in the intact polypeptide chain.

7.     **\# Convert the value to KiloDalton (kDa):** The resulting value is initially obtained in Daltons (Da). However, since protein molecular weights are commonly expressed in kilodaltons, the value is converted by dividing by 1000. The final molecular weight in kDa is then returned as the output of the function.

8.     **\# Call the Original function:** The function was tested with two example protein sequences (protein1 and protein2). The first sequence represented a valid amino acid string and successfully returned a molecular weight value. The second sequence intentionally contained invalid characters, allowing verification that the error-handling mechanism worked correctly by returning zero.